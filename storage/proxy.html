<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>度假proxy页面</title>
</head>
<body>
  这是度假客服IM代理页面 <br/>

  如果你是度假IM的客服，请将此标签页面从当前chrome中拖出，并移动到第二屏幕上 <br/>

  以后，聊天页跳转的链接，都会在此页面生成 <br/>

  关闭此页，会在聊天页所在的chrome打开新页面 <br/>

  <h3>attention，注意，初次打开可能需要点击chrome网页上方地址栏右边的小弹层，点击允许。</h3>

</body>

<script>
	window.onload = ()=>{
    function proxy () {
      window.addEventListener('storage', storageHandler, false) //localStorage or sessionStorage

      function storageHandler (e) {
        console.log(e.key)
        if (e.key === '__storageProxy__') {
          var url = window.localStorage.getItem('__storageProxy__')
          url && window.open(url)
          window.localStorage.setItem('__storageProxy__', '') //fired storage event again
        }
      }
    }

    proxy()
	}

</script>
</html>